using System;
using System.Collections.Generic;
using System.Diagnostics.Metrics;
using System.Drawing;
using System.Linq;
using System.Text;
using static System.Runtime.InteropServices.JavaScript.JSType;

var fullInput =
@"109,4798,21101,0,3124,1,21101,0,13,0,1106,0,1424,21102,166,1,1,21101,24,0,0,1106,0,1234,21102,31,1,0,1105,1,1984,1106,0,13,6,4,3,2,52,51,21,4,28,56,55,3,19,-9,-10,47,89,88,90,90,6,77,73,85,71,1,76,68,63,65,22,-27,70,76,81,87,5,105,105,107,108,95,4,97,92,109,109,5,110,105,110,108,95,4,115,96,109,109,13,-3,59,101,85,92,97,13,84,80,92,78,34,-15,26,-16,46,88,72,79,84,0,72,76,-3,85,74,79,75,-8,64,68,75,57,65,70,64,66,72,8,-41,32,-22,56,77,82,-4,60,76,62,70,-2,74,-11,55,52,68,67,73,56,60,52,-20,44,56,66,-24,48,58,42,49,54,-16,-53,10,0,56,99,96,95,82,94,83,45,-9,23,-13,61,85,88,74,71,82,73,79,73,89,67,65,-4,62,73,70,69,56,68,57,2,-35,24,-14,64,85,90,4,70,67,79,7,83,-2,68,75,-5,78,65,57,75,-10,76,53,76,0,-37,31,-21,57,78,83,-3,64,74,72,0,76,-9,73,58,57,-13,70,57,49,67,-18,54,64,48,55,-23,48,44,56,42,-14,-51,14,-4,74,95,100,14,97,77,86,79,9,92,79,75,5,27,-17,61,82,87,1,68,78,76,4,80,-5,66,58,78,60,-10,73,60,52,70,-15,57,67,51,58,-6,-43,14,-4,74,95,100,14,81,94,90,90,9,92,79,75,5,60,-50,23,42,38,-32,38,39,30,42,47,-38,30,36,28,25,41,38,34,31,18,23,29,19,33,-52,20,29,-55,27,27,27,8,15,-61,22,16,-64,24,13,18,-54,-69,-70,-14,7,12,-74,-8,-11,1,-71,5,-80,-4,-3,3,-15,-84,-85,-109,29,-19,59,80,85,-1,82,62,71,64,-6,77,64,60,-10,62,66,57,59,63,57,67,51,-19,56,58,57,57,-10,-47,44,-34,39,58,54,-16,60,61,57,64,48,56,-23,52,40,60,38,-28,44,53,-31,55,32,55,-35,48,42,41,-39,32,38,42,-42,-44,12,33,38,-48,28,19,25,32,-52,-76,-77,59,-49,13,55,-30,42,51,-33,49,50,32,31,31,39,36,48,-42,24,35,32,34,29,21,35,19,25,37,-53,14,10,26,18,-57,-59,-3,18,23,-63,1,17,3,-67,1,-4,14,-2,6,-73,-8,14,-76,-12,-78,-40,2,4,-13,-82,-106,-107,35,-25,53,74,79,0,74,60,-10,65,53,72,64,52,56,52,50,-19,53,57,62,56,-24,58,54,38,39,40,-29,-31,2,56,35,-34,-58,-59,138,-128,-74,-108,-33,-31,-26,-44,-101,-114,-33,-37,-51,-39,-35,-47,-54,-122,-37,-45,-52,-59,-58,-128,-46,-65,-42,-49,-133,-132,-102,-60,-68,-56,-55,-139,-141,-106,-61,-65,-72,-78,-64,-148,-70,-72,-151,-68,-81,-81,-72,-156,-74,-86,-86,-80,-161,-97,-81,-95,-165,-94,-98,-103,-83,-97,-102,-90,-173,-90,-103,-111,-99,-178,-95,-108,-112,-182,-115,-115,-101,-117,-120,-104,-120,-122,-191,-106,-128,-118,-110,-127,-196,-196,-199,-135,-123,-134,-203,-115,-126,-121,-207,-143,-127,-141,-211,-143,-139,-145,-148,-132,-148,-150,-219,-154,-156,-155,-148,-224,-141,-147,-227,-144,-157,-161,-231,-165,-161,-165,-168,-161,-157,-159,-166,-162,-157,-228,-265,138,-128,-74,-108,-33,-31,-26,-44,-101,-114,-33,-37,-51,-39,-35,-47,-54,-122,-37,-45,-52,-59,-58,-128,-46,-65,-42,-49,-133,-132,-102,-60,-68,-56,-55,-139,-141,-106,-61,-65,-72,-78,-64,-148,-70,-72,-151,-68,-81,-81,-72,-156,-74,-86,-86,-80,-161,-97,-81,-95,-165,-90,-94,-97,-97,-86,-102,-90,-173,-90,-103,-111,-99,-178,-95,-108,-112,-182,-115,-115,-101,-117,-120,-104,-120,-122,-191,-106,-128,-118,-110,-127,-196,-196,-199,-135,-123,-134,-203,-115,-126,-121,-207,-143,-127,-141,-211,-143,-139,-145,-148,-132,-148,-150,-219,-154,-156,-155,-148,-224,-141,-147,-227,-144,-157,-161,-231,-165,-161,-165,-168,-161,-157,-159,-166,-162,-157,-228,-265,263,-253,-199,-233,-158,-156,-151,-169,-226,-239,-158,-162,-176,-164,-160,-172,-179,-247,-162,-170,-177,-184,-183,-253,-171,-190,-167,-174,-258,-257,-227,-183,-197,-187,-175,-182,-193,-184,-268,-202,-191,-194,-192,-197,-205,-191,-207,-276,-278,-222,-201,-196,-282,-206,-219,-196,-286,-207,-206,-210,-223,-222,-223,-225,-280,-293,-296,-232,-220,-231,-300,-212,-223,-218,-304,-236,-228,-223,-239,-227,-310,-227,-240,-244,-314,-248,-237,-250,-243,-239,-247,-237,-308,-345,-273,-260,-248,-243,-263,-329,-252,-252,-248,-260,-267,-266,-253,-337,-249,-260,-255,-259,-342,-260,-267,-280,-270,-271,-348,-281,-268,-272,-279,-285,-342,-355,-280,-278,-279,-284,-277,-361,-282,-278,-274,-275,-290,-298,-300,-369,-300,-292,-290,-373,-309,-375,-299,-298,-301,-310,-302,-297,-370,-383,-302,-316,-321,-311,-315,-299,-321,-308,-392,-306,-322,-330,-312,-397,-326,-334,-317,-401,-330,-338,-324,-325,-337,-329,-339,-341,-398,-411,-347,-335,-346,-415,-334,-352,-350,-346,-341,-338,-422,-334,-345,-340,-344,-427,-345,-357,-357,-351,-432,-365,-361,-353,-367,-370,-354,-363,-351,-427,-464,-441,-397,-373,-434,-447,-376,-380,-374,-375,-373,-452,-454,-398,-377,-372,-458,-376,-388,-382,-377,-387,-396,-465,-400,-398,-468,-404,-404,-395,-403,-473,-390,-396,-476,-406,-409,-395,-480,-408,-404,-483,-418,-396,-486,-403,-399,-409,-417,-413,-421,-493,37,-5,73,71,-8,75,62,58,-12,62,55,74,64,48,50,-19,45,63,-22,61,48,44,-26,50,37,44,48,-31,33,40,48,41,43,30,37,-25,-38,-63,0,0,109,7,21101,0,0,-2,22208,-2,-5,-1,1205,-1,1169,22202,-2,-4,1,22201,1,-6,1,22101,0,-2,2,21101,0,1162,0,2106,0,-3,21201,-2,1,-2,1106,0,1136,109,-7,2105,1,0,109,6,2102,1,-5,1182,20102,1,0,-2,21101,0,0,-3,21201,-5,1,-5,22208,-3,-2,-1,1205,-1,1229,2201,-5,-3,1205,20102,1,0,1,22101,0,-3,2,22102,1,-2,3,21101,0,1222,0,2106,0,-4,21201,-3,1,-3,1105,1,1192,109,-6,2106,0,0,109,2,22101,0,-1,1,21102,1,1256,2,21101,1251,0,0,1105,1,1174,109,-2,2106,0,0,109,5,22201,-4,-3,-1,22201,-2,-1,-1,204,-1,109,-5,2106,0,0,109,3,2102,1,-2,1280,1006,0,1303,104,45,104,32,1201,-1,66,1292,20101,0,0,1,21101,0,1301,0,1106,0,1234,104,10,109,-3,2105,1,0,0,0,109,2,2101,0,-1,1309,1102,0,1,1308,21102,4601,1,1,21102,13,1,2,21102,1,4,3,21101,0,1353,4,21101,0,1343,0,1106,0,1130,20101,0,1308,-1,109,-2,2106,0,0,95,109,3,2102,1,-2,1360,20008,0,1309,-1,1206,-1,1419,1005,1308,1398,1101,1,0,1308,21008,1309,-1,-1,1206,-1,1387,21101,0,106,1,1106,0,1391,21102,92,1,1,21102,1,1398,0,1105,1,1234,104,45,104,32,1201,-2,1,1407,21002,0,1,1,21102,1417,1,0,1105,1,1234,104,10,109,-3,2105,1,0,109,3,1201,-2,0,1128,21102,1,34,1,21102,1,1441,0,1105,1,1234,1001,1128,0,1447,20101,0,0,1,21101,1456,0,0,1106,0,1234,21102,41,1,1,21102,1467,1,0,1106,0,1234,1001,1128,1,1472,21001,0,0,1,21102,1,1482,0,1105,1,1234,21102,1,46,1,21101,1493,0,0,1106,0,1234,21001,1128,3,1,21101,4,0,2,21101,1,0,3,21101,0,1273,4,21102,1516,1,0,1105,1,1130,20101,0,1128,1,21101,1527,0,0,1105,1,1310,1001,1128,2,1533,20102,1,0,-1,1206,-1,1545,21102,1545,1,0,2106,0,-1,109,-3,2106,0,0,109,0,99,109,2,1102,0,1,1550,21102,4601,1,1,21101,0,13,2,21101,4,0,3,21101,0,1664,4,21102,1,1582,0,1105,1,1130,2,2486,1352,1551,1102,0,1,1552,20102,1,1550,1,21101,33,0,2,21102,1702,1,3,21102,1,1609,0,1105,1,2722,21007,1552,0,-1,1205,-1,1630,20107,0,1552,-1,1205,-1,1637,21102,1630,1,0,1106,0,1752,21102,548,1,1,1105,1,1641,21102,1,687,1,21101,0,1648,0,1106,0,1234,21102,4457,1,1,21102,1659,1,0,1106,0,1424,109,-2,2105,1,0,109,4,21202,-2,-1,-2,2101,0,-3,1675,21008,0,-1,-1,1206,-1,1697,1201,-3,2,1687,20101,-27,0,-3,22201,-3,-2,-3,2001,1550,-3,1550,109,-4,2105,1,0,109,5,21008,1552,0,-1,1206,-1,1747,1201,-3,1901,1716,21002,0,1,-2,1205,-4,1736,20207,-2,1551,-1,1205,-1,1747,1101,-1,0,1552,1105,1,1747,22007,1551,-2,-1,1205,-1,1747,1102,1,1,1552,109,-5,2106,0,0,109,1,21101,826,0,1,21102,1,1765,0,1106,0,1234,21002,1550,1,1,21101,1776,0,0,1106,0,2863,21101,0,1090,1,21101,1787,0,0,1106,0,1234,99,1105,1,1787,109,-1,2106,0,0,109,1,21102,512,1,1,21101,0,1809,0,1106,0,1234,99,1105,1,1809,109,-1,2106,0,0,109,1,1101,1,0,1129,109,-1,2105,1,0,109,1,21101,377,0,1,21101,0,1842,0,1105,1,1234,1106,0,1831,109,-1,2105,1,0,109,1,21102,1,407,1,21101,0,1863,0,1106,0,1234,99,1105,1,1863,109,-1,2105,1,0,109,1,21102,1,452,1,21102,1885,1,0,1106,0,1234,99,1106,0,1885,109,-1,2106,0,0,1941,1947,1953,1958,1965,1972,1978,7482,8136,7612,7688,7873,7458,7911,7830,7587,7567,7523,7418,7777,7532,7439,8005,7876,7558,7921,7540,8017,8150,7578,7757,8001,8117,7830,8108,7640,7523,7584,7608,7981,2281,2468,2418,2450,2487,2125,2505,5,95,108,104,104,23,5,96,91,108,108,1,4,101,105,112,3,6,104,104,106,107,94,-1,6,109,104,109,107,94,-1,5,111,91,100,93,23,5,114,95,108,108,1,109,3,21102,1993,1,0,1105,1,2634,1006,1129,2010,21102,1,316,1,21101,0,2007,0,1106,0,1234,1105,1,2076,21101,0,0,-1,1201,-1,1894,2020,20102,1,0,1,21101,0,0,2,21101,0,0,3,21102,1,2037,0,1105,1,2525,1206,1,2054,1201,-1,1934,2050,21102,2051,1,0,106,0,0,1106,0,2076,21201,-1,1,-1,21207,-1,7,-2,1205,-2,2014,21101,177,0,1,21101,2076,0,0,1106,0,1234,109,-3,2106,0,0,109,3,2001,1128,-2,2088,21002,0,1,-1,1205,-1,2108,21102,1,201,1,21101,2105,0,0,1105,1,1234,1106,0,2119,21202,-1,1,1,21102,1,2119,0,1106,0,1424,109,-3,2105,1,0,0,109,1,1102,0,1,2124,21101,0,4601,1,21101,13,0,2,21102,1,4,3,21102,1,2173,4,21102,2154,1,0,1105,1,1130,1005,2124,2168,21102,1,226,1,21101,0,2168,0,1106,0,1234,109,-1,2106,0,0,109,3,1005,2124,2275,1201,-2,0,2183,20008,0,1128,-1,1206,-1,2275,1201,-2,1,2194,21002,0,1,-1,21201,-1,0,1,21102,1,5,2,21101,0,1,3,21102,2216,1,0,1106,0,2525,1206,1,2275,21101,0,258,1,21101,0,2230,0,1105,1,1234,21201,-1,0,1,21101,2241,0,0,1106,0,1234,104,46,104,10,1102,1,1,2124,1201,-2,0,2256,1102,1,-1,0,1201,-2,3,2262,21001,0,0,-1,1206,-1,2275,21102,1,2275,0,2106,0,-1,109,-3,2106,0,0,0,109,1,1102,1,0,2280,21102,1,4601,1,21102,1,13,2,21102,1,4,3,21102,2329,1,4,21102,2310,1,0,1105,1,1130,1005,2280,2324,21102,273,1,1,21101,0,2324,0,1106,0,1234,109,-1,2106,0,0,109,3,1005,2280,2413,1201,-2,0,2339,21008,0,-1,-1,1206,-1,2413,1201,-2,1,2351,20101,0,0,-1,21202,-1,1,1,21101,5,0,2,21101,0,1,3,21102,2372,1,0,1106,0,2525,1206,1,2413,21102,301,1,1,21102,2386,1,0,1105,1,1234,21201,-1,0,1,21102,2397,1,0,1106,0,1234,104,46,104,10,1101,1,0,2280,1201,-2,0,2412,102,1,1128,0,109,-3,2106,0,0,109,1,21102,-1,1,1,21101,0,2431,0,1106,0,1310,1205,1,2445,21101,0,133,1,21101,0,2445,0,1106,0,1234,109,-1,2105,1,0,109,1,21101,0,3,1,21102,2463,1,0,1106,0,2081,109,-1,2105,1,0,109,1,21101,0,4,1,21102,1,2481,0,1105,1,2081,109,-1,2106,0,0,85,109,1,21101,5,0,1,21101,0,2500,0,1105,1,2081,109,-1,2105,1,0,109,1,21102,6,1,1,21101,2518,0,0,1106,0,2081,109,-1,2106,0,0,0,0,109,5,1201,-3,0,2523,1102,1,1,2524,21202,-4,1,1,21101,0,2585,2,21102,2550,1,0,1106,0,1174,1206,-2,2576,1201,-4,0,2558,2001,0,-3,2566,101,3094,2566,2566,21008,0,-1,-1,1205,-1,2576,1101,0,0,2524,20101,0,2524,-4,109,-5,2106,0,0,109,5,22201,-4,-3,-4,22201,-4,-2,-4,21208,-4,10,-1,1206,-1,2606,21102,-1,1,-4,201,-3,2523,2615,1001,2615,3094,2615,21001,0,0,-1,22208,-4,-1,-1,1205,-1,2629,1101,0,0,2524,109,-5,2105,1,0,109,4,21101,3094,0,1,21102,1,30,2,21101,0,1,3,21101,0,2706,4,21101,2659,0,0,1106,0,1130,21101,0,0,-3,203,-2,21208,-2,10,-1,1205,-1,2701,21207,-2,0,-1,1205,-1,2663,21207,-3,29,-1,1206,-1,2663,2101,3094,-3,2693,1202,-2,1,0,21201,-3,1,-3,1105,1,2663,109,-4,2105,1,0,109,2,1201,-1,0,2715,1102,1,-1,0,109,-2,2106,0,0,0,109,5,1201,-2,0,2721,21207,-4,0,-1,1206,-1,2739,21101,0,0,-4,22101,0,-4,1,22102,1,-3,2,21101,0,1,3,21101,2758,0,0,1105,1,2763,109,-5,2106,0,0,109,6,21207,-4,1,-1,1206,-1,2786,22207,-5,-3,-1,1206,-1,2786,21202,-5,1,-5,1106,0,2858,21201,-5,0,1,21201,-4,-1,2,21202,-3,2,3,21101,2805,0,0,1105,1,2763,21201,1,0,-5,21102,1,1,-2,22207,-5,-3,-1,1206,-1,2824,21101,0,0,-2,22202,-3,-2,-3,22107,0,-4,-1,1206,-1,2850,22102,1,-2,1,21201,-4,-1,2,21102,1,2850,0,105,1,2721,21202,-3,-1,-3,22201,-5,-3,-5,109,-6,2105,1,0,109,3,21208,-2,0,-1,1205,-1,2902,21207,-2,0,-1,1205,-1,2882,1106,0,2888,104,45,21202,-2,-1,-2,22101,0,-2,1,21101,0,2899,0,1105,1,2909,1105,1,2904,104,48,109,-3,2105,1,0,109,4,21201,-3,0,1,21102,10,1,2,21102,2926,1,0,1105,1,3010,21202,1,1,-2,21202,2,1,-1,1206,-2,2948,21202,-2,1,1,21102,1,2948,0,1106,0,2909,22101,48,-1,-1,204,-1,109,-4,2105,1,0,1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,140737488355328,281474976710656,562949953421312,1125899906842624,109,8,21102,0,1,-4,21102,1,0,-3,21102,1,51,-2,21201,-2,-1,-2,1201,-2,2959,3034,20101,0,0,-1,21202,-3,2,-3,22207,-7,-1,-5,1205,-5,3059,21201,-3,1,-3,22102,-1,-1,-5,22201,-7,-5,-7,22207,-3,-6,-5,1205,-5,3078,22102,-1,-6,-5,22201,-3,-5,-3,22201,-1,-4,-4,1205,-2,3024,21201,-4,0,-7,21201,-3,0,-6,109,-8,2105,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3131,3143,0,0,0,3252,0,11,61,105,95,94,17,50,97,83,78,79,83,108,-19,2,7,-79,-9,-2,2,-83,-11,-7,-86,-3,-16,-7,-11,-6,-21,-21,-94,-30,-96,-25,-19,-23,-31,-101,-29,-25,-104,-21,-34,-38,-108,-39,-34,-32,-33,-31,-114,-43,-47,-35,-49,-105,-120,-69,-43,-123,-49,-56,-57,-47,-128,-40,-51,-46,-50,-133,-51,-63,-63,-57,-138,-69,-58,-62,-65,-143,-79,-69,-63,-68,-148,-79,-68,-82,-83,-63,-81,-77,-85,-145,-158,-75,-88,-92,-162,-91,-85,-89,-97,-167,-96,-104,-87,-171,-106,-104,-105,-97,-176,-94,-109,-114,-104,-112,-114,-169,3259,3271,0,3124,0,3323,3552,11,58,98,90,91,95,85,84,96,86,90,82,51,38,59,64,-22,60,45,44,-26,38,-28,58,42,42,52,36,32,44,29,45,30,-39,47,32,42,29,-44,35,30,18,30,34,-50,19,27,29,-54,-4,24,25,15,19,11,7,20,16,9,3,-66,19,-50,-55,3330,3337,0,3252,0,3378,3477,6,59,107,91,88,90,90,40,38,70,68,58,-12,66,56,-15,68,55,51,-19,47,44,44,50,54,44,58,56,-28,54,39,38,45,-33,50,44,-36,35,27,47,29,-41,38,36,43,24,36,-33,3385,3399,0,3323,0,3724,3435,13,54,100,86,103,15,63,98,77,93,94,78,90,90,35,49,68,64,-6,59,61,59,73,-11,53,69,55,-15,49,59,58,-19,64,58,57,-23,59,52,39,49,48,-29,40,48,50,-33,55,44,49,-23,3442,3450,0,0,3378,0,0,7,68,97,107,89,93,89,97,26,43,91,73,85,91,85,72,72,76,68,3,78,-6,63,74,60,59,79,57,0,54,67,57,52,50,-5,3484,3496,0,4239,3323,0,0,11,72,87,92,87,95,83,84,14,57,77,77,55,34,55,60,-26,56,41,40,-30,38,54,40,34,34,42,30,31,-39,32,28,40,26,-44,34,24,-47,32,33,29,33,27,31,35,25,13,-57,22,20,16,28,15,6,18,-65,2,2,15,4,1,7,-72,14,5,7,-1,-63,3559,3567,0,0,3252,4024,3644,7,65,89,99,98,108,85,108,76,8,27,27,36,-48,16,32,18,13,-53,18,10,27,-57,8,10,9,17,-62,16,16,19,7,10,5,21,-1,-3,-72,-3,5,7,-76,6,1,-2,-11,3,-10,-10,-6,-14,-59,-87,1,-10,-5,-84,-10,-24,-94,-21,-11,-14,-14,-99,-22,-22,-18,-103,-23,-20,-33,-23,-39,-109,-27,-26,-30,-44,-114,-28,-44,-52,-34,-105,3651,3663,0,0,3552,3892,4393,11,68,86,102,87,99,102,80,98,92,94,100,60,24,43,39,51,37,-33,31,47,33,-37,27,-39,30,28,45,-43,40,24,30,22,35,18,29,29,17,30,-27,-55,28,15,11,30,-53,21,7,-63,1,11,10,-67,-2,10,6,13,-3,-5,-74,-7,3,10,0,-67,-80,3,-10,-4,1,-14,-14,-73,3731,3740,0,3378,3965,0,3796,8,72,88,105,104,85,90,87,100,55,29,48,44,63,-20,54,40,-30,34,-32,43,39,49,48,39,31,-39,44,46,31,40,40,44,-46,18,30,19,-50,32,32,12,28,29,17,21,13,-59,24,18,-62,13,15,14,9,-67,-3,7,6,-71,-7,3,-1,0,-7,-63,3803,3814,0,0,3724,0,4093,10,68,86,106,92,89,82,100,88,93,91,77,6,38,18,36,36,33,-25,-52,-2,30,27,9,21,10,10,8,-47,-62,-15,12,4,-1,16,1,-69,13,14,8,7,2,14,-76,0,-9,-14,3,4,0,-14,-7,-16,-8,-3,-5,-89,-20,-9,-13,-16,-94,-25,-23,-27,-14,-10,-100,-18,-18,-38,-22,-22,-106,-23,-29,-109,-28,-42,-45,-48,-38,-42,-50,-35,-53,-35,-51,-107,3899,3908,0,3644,0,0,0,8,64,102,98,100,88,88,85,92,56,27,54,51,42,51,49,39,-31,51,36,35,42,47,-37,46,40,-40,31,23,43,25,-45,30,22,22,35,-50,22,32,-53,25,23,-56,27,14,10,-60,-22,11,2,14,19,-66,-28,14,4,-2,-71,11,-4,10,9,-3,1,-7,-65,3972,3995,0,0,0,0,3724,22,50,88,92,7,41,77,83,70,81,77,65,83,67,-3,34,74,79,71,76,56,63,67,28,55,82,79,70,72,78,85,9,-4,68,78,0,75,-9,73,73,61,63,62,-15,71,62,64,56,53,57,49,-9,4031,4052,0,3552,0,0,0,20,51,84,80,93,8,62,88,70,84,83,75,79,71,-1,33,66,74,79,63,75,40,32,70,77,-11,57,63,69,54,-16,51,61,-19,69,58,63,-23,63,57,39,53,-28,51,52,38,51,36,44,49,47,-37,41,39,-40,43,30,26,-44,26,33,-16,4100,4109,0,0,3796,4189,0,8,59,102,104,103,93,87,97,99,79,5,24,20,-50,26,17,31,11,21,-56,30,7,17,16,22,-62,2,14,3,-66,17,4,0,-70,6,-3,11,-9,1,-76,-7,-2,0,-1,1,-82,-18,-2,-16,-86,-4,-12,-16,-19,-19,-8,-17,-5,-95,-28,-24,-28,-29,-31,-19,-33,-25,-20,-105,-39,-28,-32,-30,-28,-28,-98,-113,-67,-33,-116,-52,-36,-50,-120,-37,-50,-54,-35,-94,4196,4204,0,4093,0,0,0,7,76,108,88,88,97,89,102,34,48,66,69,73,62,62,61,73,3,72,61,77,55,53,-2,-17,34,53,49,68,-15,59,45,-25,39,49,48,-29,39,46,48,51,55,-21,4246,4269,0,4304,0,3477,0,22,65,74,90,87,6,41,86,76,88,70,0,44,63,70,74,79,63,71,57,69,57,58,34,39,81,-4,60,74,73,61,56,72,72,-12,71,65,-15,50,52,-18,68,59,61,53,50,54,46,-26,51,51,53,47,34,44,43,55,-21,4311,4320,0,0,0,4239,0,8,75,96,89,96,20,53,83,106,72,11,44,38,37,35,37,38,36,-48,17,29,33,20,-53,-4,14,12,-44,-12,20,23,8,6,-63,-14,4,7,11,0,0,-1,11,-72,4,-5,-7,-3,-10,-5,-1,-11,-81,-17,-5,-16,-85,-4,-18,-17,-4,-14,-26,-10,-93,-12,-26,-23,-19,-30,-30,-31,-19,-102,-26,-35,-37,-33,-40,-35,-31,-41,-97,4400,4408,0,0,3644,0,4457,7,76,108,102,104,86,91,88,48,36,55,51,-19,46,58,66,46,59,-25,48,58,55,55,-30,36,47,45,50,30,37,41,-38,38,39,41,27,-43,22,34,42,22,35,-35,-50,-51,-2,16,13,30,26,26,15,27,9,15,27,-49,4464,4484,0,0,4393,0,4556,19,64,81,78,95,91,81,91,95,5,39,75,71,68,75,79,77,70,74,79,71,2,38,-41,42,29,25,-45,32,22,40,35,-50,31,27,26,23,-43,-56,8,-58,21,22,8,21,20,21,17,3,-54,15,0,8,12,1,11,-1,11,-7,-77,-8,-3,-1,-2,0,-83,3,-12,-10,-11,-88,-3,-21,-9,-19,-23,-5,-95,-7,-18,-13,-17,-100,-28,-34,-34,-26,-21,-33,-23,-19,-95,4563,4588,1553,0,4457,0,0,24,56,89,75,88,87,88,84,70,13,50,67,75,79,68,78,66,78,60,-10,27,64,66,65,67,12,53,97,83,93,105,105,87,91,83,25,24,23,3323,4653,27,1872,3965,4661,28,1818,3435,4681,134217757,0,4024,4690,262174,0,4189,4698,2079,0,4393,4709,64,0,4239,4722,33,1850,4093,4734,65570,0,3252,4738,35,1829,3552,4752,36,1796,4304,4763,2147483685,0,3724,4774,42,0,3378,4786,167,0,7,105,96,102,106,100,98,102,19,84,85,76,88,93,8,76,82,74,71,87,84,80,77,64,69,75,65,79,8,89,106,106,90,102,92,101,92,7,90,102,107,91,99,98,84,10,91,86,103,103,87,99,16,84,85,84,12,103,99,83,84,85,15,86,82,77,95,79,91,11,98,99,95,102,86,94,15,90,78,98,76,3,103,93,104,13,92,96,87,89,93,87,97,81,11,86,88,87,87,10,91,104,87,84,98,86,16,95,93,81,10,106,86,97,85,97,102,98,88,92,82,11,91,89,102,102,90,102,84,14,85,77,95,11,91,93,107,87,85,16,95,93,86,90,95";

var smallInput =
@"";

var smallest = "";

var input = smallInput;
input = fullInput;
//input = smallest;
var timer = System.Diagnostics.Stopwatch.StartNew();

var result = 0l;


var newLine = (char)10;
var main = "C,A,C,B,C,A,B,A,B,A";
var a = "R,8,L,12,R,4,R,4";
var b = "R,8,L,10,R,8";
var c = "R,8,L,10,L,12,R,4";
var video = "n";
var inputs = new[] { main, a, b, c, video };

var operations = new Dictionary<long, long>();
var array = input.Split(",").Select(long.Parse).ToArray();
for (long i = 0; i < array.Length; i++)
{
    operations[i] = array[i];
}

var machine = new StateMachine { operations = operations };
var stopOutput = long.MinValue;
var str = "";


//foreach (var input2 in inputs)
//{
//    foreach (var item in input2)
//    {
//        machine.inputBuffer.Enqueue(item);
//    }
//    machine.inputBuffer.Enqueue(newLine);
//}

var items = new[]
{
"asterisk",
"antenna",
"easter egg",
"space heater",
"jam",
"tambourine",
"festive hat",
"fixed point"
};

var combinations = Combinations(items).Where(x => x.Length > 0).ToList();
IEnumerable<T[]> Combinations<T>(IEnumerable<T> source)
{
    if (null == source)
        throw new ArgumentNullException(nameof(source));

    T[] data = source.ToArray();

    return Enumerable
      .Range(0, 1 << (data.Length))
      .Select(index => data
         .Where((v, i) => (index & (1 << i)) != 0)
         .ToArray());
}

foreach (var combination in combinations)
{
    int i = 0;

    var restore = "";
    restore = "1268||4811||0,109=1,4798=2,21101=3,0=4,3124=5,1=6,21101=7,0=8,13=9,0=10,1106=11,0=12,1424=13,21102=14,166=15,1=16,1=17,21101=18,24=19,0=20,0=21,1106=22,0=23,1234=24,21102=25,31=26,1=27,0=28,1105=29,1=30,1984=31,1106=32,0=33,13=34,6=35,4=36,3=37,2=38,52=39,51=40,21=41,4=42,28=43,56=44,55=45,3=46,19=47,-9=48,-10=49,47=50,89=51,88=52,90=53,90=54,6=55,77=56,73=57,85=58,71=59,1=60,76=61,68=62,63=63,65=64,22=65,-27=66,70=67,76=68,81=69,87=70,5=71,105=72,105=73,107=74,108=75,95=76,4=77,97=78,92=79,109=80,109=81,5=82,110=83,105=84,110=85,108=86,95=87,4=88,115=89,96=90,109=91,109=92,13=93,-3=94,59=95,101=96,85=97,92=98,97=99,13=100,84=101,80=102,92=103,78=104,34=105,-15=106,26=107,-16=108,46=109,88=110,72=111,79=112,84=113,0=114,72=115,76=116,-3=117,85=118,74=119,79=120,75=121,-8=122,64=123,68=124,75=125,57=126,65=127,70=128,64=129,66=130,72=131,8=132,-41=133,32=134,-22=135,56=136,77=137,82=138,-4=139,60=140,76=141,62=142,70=143,-2=144,74=145,-11=146,55=147,52=148,68=149,67=150,73=151,56=152,60=153,52=154,-20=155,44=156,56=157,66=158,-24=159,48=160,58=161,42=162,49=163,54=164,-16=165,-53=166,10=167,0=168,56=169,99=170,96=171,95=172,82=173,94=174,83=175,45=176,-9=177,23=178,-13=179,61=180,85=181,88=182,74=183,71=184,82=185,73=186,79=187,73=188,89=189,67=190,65=191,-4=192,62=193,73=194,70=195,69=196,56=197,68=198,57=199,2=200,-35=201,24=202,-14=203,64=204,85=205,90=206,4=207,70=208,67=209,79=210,7=211,83=212,-2=213,68=214,75=215,-5=216,78=217,65=218,57=219,75=220,-10=221,76=222,53=223,76=224,0=225,-37=226,31=227,-21=228,57=229,78=230,83=231,-3=232,64=233,74=234,72=235,0=236,76=237,-9=238,73=239,58=240,57=241,-13=242,70=243,57=244,49=245,67=246,-18=247,54=248,64=249,48=250,55=251,-23=252,48=253,44=254,56=255,42=256,-14=257,-51=258,14=259,-4=260,74=261,95=262,100=263,14=264,97=265,77=266,86=267,79=268,9=269,92=270,79=271,75=272,5=273,27=274,-17=275,61=276,82=277,87=278,1=279,68=280,78=281,76=282,4=283,80=284,-5=285,66=286,58=287,78=288,60=289,-10=290,73=291,60=292,52=293,70=294,-15=295,57=296,67=297,51=298,58=299,-6=300,-43=301,14=302,-4=303,74=304,95=305,100=306,14=307,81=308,94=309,90=310,90=311,9=312,92=313,79=314,75=315,5=316,60=317,-50=318,23=319,42=320,38=321,-32=322,38=323,39=324,30=325,42=326,47=327,-38=328,30=329,36=330,28=331,25=332,41=333,38=334,34=335,31=336,18=337,23=338,29=339,19=340,33=341,-52=342,20=343,29=344,-55=345,27=346,27=347,27=348,8=349,15=350,-61=351,22=352,16=353,-64=354,24=355,13=356,18=357,-54=358,-69=359,-70=360,-14=361,7=362,12=363,-74=364,-8=365,-11=366,1=367,-71=368,5=369,-80=370,-4=371,-3=372,3=373,-15=374,-84=375,-85=376,-109=377,29=378,-19=379,59=380,80=381,85=382,-1=383,82=384,62=385,71=386,64=387,-6=388,77=389,64=390,60=391,-10=392,62=393,66=394,57=395,59=396,63=397,57=398,67=399,51=400,-19=401,56=402,58=403,57=404,57=405,-10=406,-47=407,44=408,-34=409,39=410,58=411,54=412,-16=413,60=414,61=415,57=416,64=417,48=418,56=419,-23=420,52=421,40=422,60=423,38=424,-28=425,44=426,53=427,-31=428,55=429,32=430,55=431,-35=432,48=433,42=434,41=435,-39=436,32=437,38=438,42=439,-42=440,-44=441,12=442,33=443,38=444,-48=445,28=446,19=447,25=448,32=449,-52=450,-76=451,-77=452,59=453,-49=454,13=455,55=456,-30=457,42=458,51=459,-33=460,49=461,50=462,32=463,31=464,31=465,39=466,36=467,48=468,-42=469,24=470,35=471,32=472,34=473,29=474,21=475,35=476,19=477,25=478,37=479,-53=480,14=481,10=482,26=483,18=484,-57=485,-59=486,-3=487,18=488,23=489,-63=490,1=491,17=492,3=493,-67=494,1=495,-4=496,14=497,-2=498,6=499,-73=500,-8=501,14=502,-76=503,-12=504,-78=505,-40=506,2=507,4=508,-13=509,-82=510,-106=511,-107=512,35=513,-25=514,53=515,74=516,79=517,0=518,74=519,60=520,-10=521,65=522,53=523,72=524,64=525,52=526,56=527,52=528,50=529,-19=530,53=531,57=532,62=533,56=534,-24=535,58=536,54=537,38=538,39=539,40=540,-29=541,-31=542,2=543,56=544,35=545,-34=546,-58=547,-59=548,138=549,-128=550,-74=551,-108=552,-33=553,-31=554,-26=555,-44=556,-101=557,-114=558,-33=559,-37=560,-51=561,-39=562,-35=563,-47=564,-54=565,-122=566,-37=567,-45=568,-52=569,-59=570,-58=571,-128=572,-46=573,-65=574,-42=575,-49=576,-133=577,-132=578,-102=579,-60=580,-68=581,-56=582,-55=583,-139=584,-141=585,-106=586,-61=587,-65=588,-72=589,-78=590,-64=591,-148=592,-70=593,-72=594,-151=595,-68=596,-81=597,-81=598,-72=599,-156=600,-74=601,-86=602,-86=603,-80=604,-161=605,-97=606,-81=607,-95=608,-165=609,-94=610,-98=611,-103=612,-83=613,-97=614,-102=615,-90=616,-173=617,-90=618,-103=619,-111=620,-99=621,-178=622,-95=623,-108=624,-112=625,-182=626,-115=627,-115=628,-101=629,-117=630,-120=631,-104=632,-120=633,-122=634,-191=635,-106=636,-128=637,-118=638,-110=639,-127=640,-196=641,-196=642,-199=643,-135=644,-123=645,-134=646,-203=647,-115=648,-126=649,-121=650,-207=651,-143=652,-127=653,-141=654,-211=655,-143=656,-139=657,-145=658,-148=659,-132=660,-148=661,-150=662,-219=663,-154=664,-156=665,-155=666,-148=667,-224=668,-141=669,-147=670,-227=671,-144=672,-157=673,-161=674,-231=675,-165=676,-161=677,-165=678,-168=679,-161=680,-157=681,-159=682,-166=683,-162=684,-157=685,-228=686,-265=687,138=688,-128=689,-74=690,-108=691,-33=692,-31=693,-26=694,-44=695,-101=696,-114=697,-33=698,-37=699,-51=700,-39=701,-35=702,-47=703,-54=704,-122=705,-37=706,-45=707,-52=708,-59=709,-58=710,-128=711,-46=712,-65=713,-42=714,-49=715,-133=716,-132=717,-102=718,-60=719,-68=720,-56=721,-55=722,-139=723,-141=724,-106=725,-61=726,-65=727,-72=728,-78=729,-64=730,-148=731,-70=732,-72=733,-151=734,-68=735,-81=736,-81=737,-72=738,-156=739,-74=740,-86=741,-86=742,-80=743,-161=744,-97=745,-81=746,-95=747,-165=748,-90=749,-94=750,-97=751,-97=752,-86=753,-102=754,-90=755,-173=756,-90=757,-103=758,-111=759,-99=760,-178=761,-95=762,-108=763,-112=764,-182=765,-115=766,-115=767,-101=768,-117=769,-120=770,-104=771,-120=772,-122=773,-191=774,-106=775,-128=776,-118=777,-110=778,-127=779,-196=780,-196=781,-199=782,-135=783,-123=784,-134=785,-203=786,-115=787,-126=788,-121=789,-207=790,-143=791,-127=792,-141=793,-211=794,-143=795,-139=796,-145=797,-148=798,-132=799,-148=800,-150=801,-219=802,-154=803,-156=804,-155=805,-148=806,-224=807,-141=808,-147=809,-227=810,-144=811,-157=812,-161=813,-231=814,-165=815,-161=816,-165=817,-168=818,-161=819,-157=820,-159=821,-166=822,-162=823,-157=824,-228=825,-265=826,263=827,-253=828,-199=829,-233=830,-158=831,-156=832,-151=833,-169=834,-226=835,-239=836,-158=837,-162=838,-176=839,-164=840,-160=841,-172=842,-179=843,-247=844,-162=845,-170=846,-177=847,-184=848,-183=849,-253=850,-171=851,-190=852,-167=853,-174=854,-258=855,-257=856,-227=857,-183=858,-197=859,-187=860,-175=861,-182=862,-193=863,-184=864,-268=865,-202=866,-191=867,-194=868,-192=869,-197=870,-205=871,-191=872,-207=873,-276=874,-278=875,-222=876,-201=877,-196=878,-282=879,-206=880,-219=881,-196=882,-286=883,-207=884,-206=885,-210=886,-223=887,-222=888,-223=889,-225=890,-280=891,-293=892,-296=893,-232=894,-220=895,-231=896,-300=897,-212=898,-223=899,-218=900,-304=901,-236=902,-228=903,-223=904,-239=905,-227=906,-310=907,-227=908,-240=909,-244=910,-314=911,-248=912,-237=913,-250=914,-243=915,-239=916,-247=917,-237=918,-308=919,-345=920,-273=921,-260=922,-248=923,-243=924,-263=925,-329=926,-252=927,-252=928,-248=929,-260=930,-267=931,-266=932,-253=933,-337=934,-249=935,-260=936,-255=937,-259=938,-342=939,-260=940,-267=941,-280=942,-270=943,-271=944,-348=945,-281=946,-268=947,-272=948,-279=949,-285=950,-342=951,-355=952,-280=953,-278=954,-279=955,-284=956,-277=957,-361=958,-282=959,-278=960,-274=961,-275=962,-290=963,-298=964,-300=965,-369=966,-300=967,-292=968,-290=969,-373=970,-309=971,-375=972,-299=973,-298=974,-301=975,-310=976,-302=977,-297=978,-370=979,-383=980,-302=981,-316=982,-321=983,-311=984,-315=985,-299=986,-321=987,-308=988,-392=989,-306=990,-322=991,-330=992,-312=993,-397=994,-326=995,-334=996,-317=997,-401=998,-330=999,-338=1000,-324=1001,-325=1002,-337=1003,-329=1004,-339=1005,-341=1006,-398=1007,-411=1008,-347=1009,-335=1010,-346=1011,-415=1012,-334=1013,-352=1014,-350=1015,-346=1016,-341=1017,-338=1018,-422=1019,-334=1020,-345=1021,-340=1022,-344=1023,-427=1024,-345=1025,-357=1026,-357=1027,-351=1028,-432=1029,-365=1030,-361=1031,-353=1032,-367=1033,-370=1034,-354=1035,-363=1036,-351=1037,-427=1038,-464=1039,-441=1040,-397=1041,-373=1042,-434=1043,-447=1044,-376=1045,-380=1046,-374=1047,-375=1048,-373=1049,-452=1050,-454=1051,-398=1052,-377=1053,-372=1054,-458=1055,-376=1056,-388=1057,-382=1058,-377=1059,-387=1060,-396=1061,-465=1062,-400=1063,-398=1064,-468=1065,-404=1066,-404=1067,-395=1068,-403=1069,-473=1070,-390=1071,-396=1072,-476=1073,-406=1074,-409=1075,-395=1076,-480=1077,-408=1078,-404=1079,-483=1080,-418=1081,-396=1082,-486=1083,-403=1084,-399=1085,-409=1086,-417=1087,-413=1088,-421=1089,-493=1090,37=1091,-5=1092,73=1093,71=1094,-8=1095,75=1096,62=1097,58=1098,-12=1099,62=1100,55=1101,74=1102,64=1103,48=1104,50=1105,-19=1106,45=1107,63=1108,-22=1109,61=1110,48=1111,44=1112,-26=1113,50=1114,37=1115,44=1116,48=1117,-31=1118,33=1119,40=1120,48=1121,41=1122,43=1123,30=1124,37=1125,-25=1126,-38=1127,-63=1128,4457=1129,0=1130,109=1131,7=1132,21101=1133,0=1134,0=1135,-2=1136,22208=1137,-2=1138,-5=1139,-1=1140,1205=1141,-1=1142,1169=1143,22202=1144,-2=1145,-4=1146,1=1147,22201=1148,1=1149,-6=1150,1=1151,22101=1152,0=1153,-2=1154,2=1155,21101=1156,0=1157,1162=1158,0=1159,2106=1160,0=1161,-3=1162,21201=1163,-2=1164,1=1165,-2=1166,1106=1167,0=1168,1136=1169,109=1170,-7=1171,2105=1172,1=1173,0=1174,109=1175,6=1176,2102=1177,1=1178,-5=1179,1182=1180,20102=1181,1=1182,166=1183,-2=1184,21101=1185,0=1186,0=1187,-3=1188,21201=1189,-5=1190,1=1191,-5=1192,22208=1193,-3=1194,-2=1195,-1=1196,1205=1197,-1=1198,1229=1199,2201=1200,-5=1201,-3=1202,1205=1203,20102=1204,1=1205,176=1206,1=1207,22101=1208,0=1209,-3=1210,2=1211,22102=1212,1=1213,-2=1214,3=1215,21101=1216,0=1217,1222=1218,0=1219,2106=1220,0=1221,-4=1222,21201=1223,-3=1224,1=1225,-3=1226,1105=1227,1=1228,1192=1229,109=1230,-6=1231,2106=1232,0=1233,0=1234,109=1235,2=1236,22101=1237,0=1238,-1=1239,1=1240,21102=1241,1=1242,1256=1243,2=1244,21101=1245,1251=1246,0=1247,0=1248,1105=1249,1=1250,1174=1251,109=1252,-2=1253,2106=1254,0=1255,0=1256,109=1257,5=1258,22201=1259,-4=1260,-3=1261,-1=1262,22201=1263,-2=1264,-1=1265,-1=1266,204=1267,-1=1268,109=1269,-5=1270,2106=1271,0=1272,0=1273,109=1274,3=1275,2102=1276,1=1277,-2=1278,1280=1279,1006=1280,4463=1281,1303=1282,104=1283,45=1284,104=1285,32=1286,1201=1287,-1=1288,66=1289,1292=1290,20101=1291,0=1292,69=1293,1=1294,21101=1295,0=1296,1301=1297,0=1298,1106=1299,0=1300,1234=1301,104=1302,10=1303,109=1304,-3=1305,2105=1306,1=1307,0=1308,0=1309,-1=1310,109=1311,2=1312,2101=1313,0=1314,-1=1315,1309=1316,1102=1317,0=1318,1=1319,1308=1320,21102=1321,4601=1322,1=1323,1=1324,21102=1325,13=1326,1=1327,2=1328,21102=1329,1=1330,4=1331,3=1332,21101=1333,0=1334,1353=1335,4=1336,21101=1337,0=1338,1343=1339,0=1340,1106=1341,0=1342,1130=1343,20101=1344,0=1345,1308=1346,-1=1347,109=1348,-2=1349,2106=1350,0=1351,0=1352,95=1353,109=1354,3=1355,2102=1356,1=1357,-2=1358,1360=1359,20008=1360,4649=1361,1309=1362,-1=1363,1206=1364,-1=1365,1419=1366,1005=1367,1308=1368,1398=1369,1101=1370,1=1371,0=1372,1308=1373,21008=1374,1309=1375,-1=1376,-1=1377,1206=1378,-1=1379,1387=1380,21101=1381,0=1382,106=1383,1=1384,1106=1385,0=1386,1391=1387,21102=1388,92=1389,1=1390,1=1391,21102=1392,1=1393,1398=1394,0=1395,1105=1396,1=1397,1234=1398,104=1399,45=1400,104=1401,32=1402,1201=1403,-2=1404,1=1405,1407=1406,21002=1407,4650=1408,1=1409,1=1410,21102=1411,1417=1412,1=1413,0=1414,1105=1415,1=1416,1234=1417,104=1418,10=1419,109=1420,-3=1421,2105=1422,1=1423,0=1424,109=1425,3=1426,1201=1427,-2=1428,0=1429,1128=1430,21102=1431,1=1432,34=1433,1=1434,21102=1435,1=1436,1441=1437,0=1438,1105=1439,1=1440,1234=1441,1001=1442,1128=1443,0=1444,1447=1445,20101=1446,0=1447,4457=1448,1=1449,21101=1450,1456=1451,0=1452,0=1453,1106=1454,0=1455,1234=1456,21102=1457,41=1458,1=1459,1=1460,21102=1461,1467=1462,1=1463,0=1464,1106=1465,0=1466,1234=1467,1001=1468,1128=1469,1=1470,1472=1471,21001=1472,4458=1473,0=1474,1=1475,21102=1476,1=1477,1482=1478,0=1479,1105=1480,1=1481,1234=1482,21102=1483,1=1484,46=1485,1=1486,21101=1487,1493=1488,0=1489,0=1490,1106=1491,0=1492,1234=1493,21001=1494,1128=1495,3=1496,1=1497,21101=1498,4=1499,0=1500,2=1501,21101=1502,1=1503,0=1504,3=1505,21101=1506,0=1507,1273=1508,4=1509,21102=1510,1516=1511,1=1512,0=1513,1105=1514,1=1515,1130=1516,20101=1517,0=1518,1128=1519,1=1520,21101=1521,1527=1522,0=1523,0=1524,1105=1525,1=1526,1310=1527,1001=1528,1128=1529,2=1530,1533=1531,20102=1532,1=1533,4459=1534,-1=1535,1206=1536,-1=1537,1545=1538,21102=1539,1545=1540,1=1541,0=1542,2106=1543,0=1544,-1=1545,109=1546,-3=1547,2106=1548,0=1549,0=1550,262144=1551,8075=1552,-1=1553,109=1554,2=1555,1102=1556,0=1557,1=1558,1550=1559,21102=1560,4601=1561,1=1562,1=1563,21101=1564,0=1565,13=1566,2=1567,21101=1568,4=1569,0=1570,3=1571,21101=1572,0=1573,1664=1574,4=1575,21102=1576,1=1577,1582=1578,0=1579,1105=1580,1=1581,1130=1582,2=1583,2486=1584,1352=1585,1551=1586,1102=1587,0=1588,1=1589,1552=1590,20102=1591,1=1592,1550=1593,1=1594,21101=1595,33=1596,0=1597,2=1598,21102=1599,1702=1600,1=1601,3=1602,21102=1603,1=1604,1609=1605,0=1606,1105=1607,1=1608,2722=1609,21007=1610,1552=1611,0=1612,-1=1613,1205=1614,-1=1615,1630=1616,20107=1617,0=1618,1552=1619,-1=1620,1205=1621,-1=1622,1637=1623,21102=1624,1630=1625,1=1626,0=1627,1106=1628,0=1629,1752=1630,21102=1631,548=1632,1=1633,1=1634,1105=1635,1=1636,1641=1637,21102=1638,1=1639,687=1640,1=1641,21101=1642,0=1643,1648=1644,0=1645,1106=1646,0=1647,1234=1648,21102=1649,4457=1650,1=1651,1=1652,21102=1653,1659=1654,1=1655,0=1656,1106=1657,0=1658,1424=1659,109=1660,-2=1661,2105=1662,1=1663,0=1664,109=1665,4=1666,21202=1667,-2=1668,-1=1669,-2=1670,2101=1671,0=1672,-3=1673,1675=1674,21008=1675,4649=1676,-1=1677,-1=1678,1206=1679,-1=1680,1697=1681,1201=1682,-3=1683,2=1684,1687=1685,20101=1686,-27=1687,4615=1688,-3=1689,22201=1690,-3=1691,-2=1692,-3=1693,2001=1694,1550=1695,-3=1696,1550=1697,109=1698,-4=1699,2105=1700,1=1701,0=1702,109=1703,5=1704,21008=1705,1552=1706,0=1707,-1=1708,1206=1709,-1=1710,1747=1711,1201=1712,-3=1713,1901=1714,1716=1715,21002=1716,1902=1717,1=1718,-2=1719,1205=1720,-4=1721,1736=1722,20207=1723,-2=1724,1551=1725,-1=1726,1205=1727,-1=1728,1747=1729,1101=1730,-1=1731,0=1732,1552=1733,1105=1734,1=1735,1747=1736,22007=1737,1551=1738,-2=1739,-1=1740,1205=1741,-1=1742,1747=1743,1102=1744,1=1745,1=1746,1552=1747,109=1748,-5=1749,2106=1750,0=1751,0=1752,109=1753,1=1754,21101=1755,826=1756,0=1757,1=1758,21102=1759,1=1760,1765=1761,0=1762,1106=1763,0=1764,1234=1765,21002=1766,1550=1767,1=1768,1=1769,21101=1770,1776=1771,0=1772,0=1773,1106=1774,0=1775,2863=1776,21101=1777,0=1778,1090=1779,1=1780,21101=1781,1787=1782,0=1783,0=1784,1106=1785,0=1786,1234=1787,99=1788,1105=1789,1=1790,1787=1791,109=1792,-1=1793,2106=1794,0=1795,0=1796,109=1797,1=1798,21102=1799,512=1800,1=1801,1=1802,21101=1803,0=1804,1809=1805,0=1806,1106=1807,0=1808,1234=1809,99=1810,1105=1811,1=1812,1809=1813,109=1814,-1=1815,2106=1816,0=1817,0=1818,109=1819,1=1820,1101=1821,1=1822,0=1823,1129=1824,109=1825,-1=1826,2105=1827,1=1828,0=1829,109=1830,1=1831,21101=1832,377=1833,0=1834,1=1835,21101=1836,0=1837,1842=1838,0=1839,1105=1840,1=1841,1234=1842,1106=1843,0=1844,1831=1845,109=1846,-1=1847,2105=1848,1=1849,0=1850,109=1851,1=1852,21102=1853,1=1854,407=1855,1=1856,21101=1857,0=1858,1863=1859,0=1860,1106=1861,0=1862,1234=1863,99=1864,1105=1865,1=1866,1863=1867,109=1868,-1=1869,2105=1870,1=1871,0=1872,109=1873,1=1874,21102=1875,1=1876,452=1877,1=1878,21102=1879,1885=1880,1=1881,0=1882,1106=1883,0=1884,1234=1885,99=1886,1106=1887,0=1888,1885=1889,109=1890,-1=1891,2106=1892,0=1893,0=1894,1941=1895,1947=1896,1953=1897,1958=1898,1965=1899,1972=1900,1978=1901,7482=1902,8136=1903,7612=1904,7688=1905,7873=1906,7458=1907,7911=1908,7830=1909,7587=1910,7567=1911,7523=1912,7418=1913,7777=1914,7532=1915,7439=1916,8005=1917,7876=1918,7558=1919,7921=1920,7540=1921,8017=1922,8150=1923,7578=1924,7757=1925,8001=1926,8117=1927,7830=1928,8108=1929,7640=1930,7523=1931,7584=1932,7608=1933,7981=1934,2281=1935,2468=1936,2418=1937,2450=1938,2487=1939,2125=1940,2505=1941,5=1942,95=1943,108=1944,104=1945,104=1946,23=1947,5=1948,96=1949,91=1950,108=1951,108=1952,1=1953,4=1954,101=1955,105=1956,112=1957,3=1958,6=1959,104=1960,104=1961,106=1962,107=1963,94=1964,-1=1965,6=1966,109=1967,104=1968,109=1969,107=1970,94=1971,-1=1972,5=1973,111=1974,91=1975,100=1976,93=1977,23=1978,5=1979,114=1980,95=1981,108=1982,108=1983,1=1984,109=1985,3=1986,21102=1987,1993=1988,1=1989,0=1990,1105=1991,1=1992,2634=1993,1006=1994,1129=1995,2010=1996,21102=1997,1=1998,316=1999,1=2000,21101=2001,0=2002,2007=2003,0=2004,1106=2005,0=2006,1234=2007,1105=2008,1=2009,2076=2010,21101=2011,0=2012,0=2013,-1=2014,1201=2015,-1=2016,1894=2017,2020=2018,20102=2019,1=2020,1896=2021,1=2022,21101=2023,0=2024,0=2025,2=2026,21101=2027,0=2028,0=2029,3=2030,21102=2031,1=2032,2037=2033,0=2034,1105=2035,1=2036,2525=2037,1206=2038,1=2039,2054=2040,1201=2041,-1=2042,1934=2043,2050=2044,21102=2045,2051=2046,1=2047,0=2048,106=2049,0=2050,1936=2051,1106=2052,0=2053,2076=2054,21201=2055,-1=2056,1=2057,-1=2058,21207=2059,-1=2060,7=2061,-2=2062,1205=2063,-2=2064,2014=2065,21101=2066,177=2067,0=2068,1=2069,21101=2070,2076=2071,0=2072,0=2073,1106=2074,0=2075,1234=2076,109=2077,-3=2078,2106=2079,0=2080,0=2081,109=2082,3=2083,2001=2084,1128=2085,-2=2086,2088=2087,21002=2088,4463=2089,1=2090,-1=2091,1205=2092,-1=2093,2108=2094,21102=2095,1=2096,201=2097,1=2098,21101=2099,2105=2100,0=2101,0=2102,1105=2103,1=2104,1234=2105,1106=2106,0=2107,2119=2108,21202=2109,-1=2110,1=2111,1=2112,21102=2113,1=2114,2119=2115,0=2116,1106=2117,0=2118,1424=2119,109=2120,-3=2121,2105=2122,1=2123,0=2124,1=2125,109=2126,1=2127,1102=2128,0=2129,1=2130,2124=2131,21101=2132,0=2133,4601=2134,1=2135,21101=2136,13=2137,0=2138,2=2139,21102=2140,1=2141,4=2142,3=2143,21102=2144,1=2145,2173=2146,4=2147,21102=2148,2154=2149,1=2150,0=2151,1105=2152,1=2153,1130=2154,1005=2155,2124=2156,2168=2157,21102=2158,1=2159,226=2160,1=2161,21101=2162,0=2163,2168=2164,0=2165,1106=2166,0=2167,1234=2168,109=2169,-1=2170,2106=2171,0=2172,0=2173,109=2174,3=2175,1005=2176,2124=2177,2275=2178,1201=2179,-2=2180,0=2181,2183=2182,20008=2183,4613=2184,1128=2185,-1=2186,1206=2187,-1=2188,2275=2189,1201=2190,-2=2191,1=2192,2194=2193,21002=2194,4614=2195,1=2196,-1=2197,21201=2198,-1=2199,0=2200,1=2201,21102=2202,1=2203,5=2204,2=2205,21101=2206,0=2207,1=2208,3=2209,21102=2210,2216=2211,1=2212,0=2213,1106=2214,0=2215,2525=2216,1206=2217,1=2218,2275=2219,21101=2220,0=2221,258=2222,1=2223,21101=2224,0=2225,2230=2226,0=2227,1105=2228,1=2229,1234=2230,21201=2231,-1=2232,0=2233,1=2234,21101=2235,2241=2236,0=2237,0=2238,1106=2239,0=2240,1234=2241,104=2242,46=2243,104=2244,10=2245,1102=2246,1=2247,1=2248,2124=2249,1201=2250,-2=2251,0=2252,2256=2253,1102=2254,1=2255,-1=2256,4613=2257,1201=2258,-2=2259,3=2260,2262=2261,21001=2262,4616=2263,0=2264,-1=2265,1206=2266,-1=2267,2275=2268,21102=2269,1=2270,2275=2271,0=2272,2106=2273,0=2274,-1=2275,109=2276,-3=2277,2106=2278,0=2279,0=2280,1=2281,109=2282,1=2283,1102=2284,1=2285,0=2286,2280=2287,21102=2288,1=2289,4601=2290,1=2291,21102=2292,1=2293,13=2294,2=2295,21102=2296,1=2297,4=2298,3=2299,21102=2300,2329=2301,1=2302,4=2303,21102=2304,2310=2305,1=2306,0=2307,1105=2308,1=2309,1130=2310,1005=2311,2280=2312,2324=2313,21102=2314,273=2315,1=2316,1=2317,21101=2318,0=2319,2324=2320,0=2321,1106=2322,0=2323,1234=2324,109=2325,-1=2326,2106=2327,0=2328,0=2329,109=2330,3=2331,1005=2332,2280=2333,2413=2334,1201=2335,-2=2336,0=2337,2339=2338,21008=2339,4613=2340,-1=2341,-1=2342,1206=2343,-1=2344,2413=2345,1201=2346,-2=2347,1=2348,2351=2349,20101=2350,0=2351,4614=2352,-1=2353,21202=2354,-1=2355,1=2356,1=2357,21101=2358,5=2359,0=2360,2=2361,21101=2362,0=2363,1=2364,3=2365,21102=2366,2372=2367,1=2368,0=2369,1106=2370,0=2371,2525=2372,1206=2373,1=2374,2413=2375,21102=2376,301=2377,1=2378,1=2379,21102=2380,2386=2381,1=2382,0=2383,1105=2384,1=2385,1234=2386,21201=2387,-1=2388,0=2389,1=2390,21102=2391,2397=2392,1=2393,0=2394,1106=2395,0=2396,1234=2397,104=2398,46=2399,104=2400,10=2401,1101=2402,1=2403,0=2404,2280=2405,1201=2406,-2=2407,0=2408,2412=2409,102=2410,1=2411,1128=2412,4613=2413,109=2414,-3=2415,2106=2416,0=2417,0=2418,109=2419,1=2420,21102=2421,-1=2422,1=2423,1=2424,21101=2425,0=2426,2431=2427,0=2428,1106=2429,0=2430,1310=2431,1205=2432,1=2433,2445=2434,21101=2435,0=2436,133=2437,1=2438,21101=2439,0=2440,2445=2441,0=2442,1106=2443,0=2444,1234=2445,109=2446,-1=2447,2105=2448,1=2449,0=2450,109=2451,1=2452,21101=2453,0=2454,3=2455,1=2456,21102=2457,2463=2458,1=2459,0=2460,1106=2461,0=2462,2081=2463,109=2464,-1=2465,2105=2466,1=2467,0=2468,109=2469,1=2470,21101=2471,0=2472,4=2473,1=2474,21102=2475,1=2476,2481=2477,0=2478,1105=2479,1=2480,2081=2481,109=2482,-1=2483,2106=2484,0=2485,0=2486,85=2487,109=2488,1=2489,21101=2490,5=2491,0=2492,1=2493,21101=2494,0=2495,2500=2496,0=2497,1105=2498,1=2499,2081=2500,109=2501,-1=2502,2105=2503,1=2504,0=2505,109=2506,1=2507,21102=2508,6=2509,1=2510,1=2511,21101=2512,2518=2513,0=2514,0=2515,1106=2516,0=2517,2081=2518,109=2519,-1=2520,2106=2521,0=2522,0=2523,0=2524,1=2525,109=2526,5=2527,1201=2528,-3=2529,0=2530,2523=2531,1102=2532,1=2533,1=2534,2524=2535,21202=2536,-4=2537,1=2538,1=2539,21101=2540,0=2541,2585=2542,2=2543,21102=2544,2550=2545,1=2546,0=2547,1106=2548,0=2549,1174=2550,1206=2551,-2=2552,2576=2553,1201=2554,-4=2555,0=2556,2558=2557,2001=2558,4690=2559,-3=2560,2566=2561,101=2562,3094=2563,2566=2564,2566=2565,21008=2566,3106=2567,-1=2568,-1=2569,1205=2570,-1=2571,2576=2572,1101=2573,0=2574,0=2575,2524=2576,20101=2577,0=2578,2524=2579,-4=2580,109=2581,-5=2582,2106=2583,0=2584,0=2585,109=2586,5=2587,22201=2588,-4=2589,-3=2590,-4=2591,22201=2592,-4=2593,-2=2594,-4=2595,21208=2596,-4=2597,10=2598,-1=2599,1206=2600,-1=2601,2606=2602,21102=2603,-1=2604,1=2605,-4=2606,201=2607,-3=2608,2523=2609,2615=2610,1001=2611,2615=2612,3094=2613,2615=2614,21001=2615,3097=2616,0=2617,-1=2618,22208=2619,-4=2620,-1=2621,-1=2622,1205=2623,-1=2624,2629=2625,1101=2626,0=2627,0=2628,2524=2629,109=2630,-5=2631,2105=2632,1=2633,0=2634,109=2635,4=2636,21101=2637,3094=2638,0=2639,1=2640,21102=2641,1=2642,30=2643,2=2644,21101=2645,0=2646,1=2647,3=2648,21101=2649,0=2650,2706=2651,4=2652,21101=2653,2659=2654,0=2655,0=2656,1106=2657,0=2658,1130=2659,21101=2660,0=2661,0=2662,-3=2663,203=2664,-2=2665,21208=2666,-2=2667,10=2668,-1=2669,1205=2670,-1=2671,2701=2672,21207=2673,-2=2674,0=2675,-1=2676,1205=2677,-1=2678,2663=2679,21207=2680,-3=2681,29=2682,-1=2683,1206=2684,-1=2685,2663=2686,2101=2687,3094=2688,-3=2689,2693=2690,1202=2691,-2=2692,1=2693,3096=2694,21201=2695,-3=2696,1=2697,-3=2698,1105=2699,1=2700,2663=2701,109=2702,-4=2703,2105=2704,1=2705,0=2706,109=2707,2=2708,1201=2709,-1=2710,0=2711,2715=2712,1102=2713,1=2714,-1=2715,3123=2716,109=2717,-2=2718,2106=2719,0=2720,0=2721,1702=2722,109=2723,5=2724,1201=2725,-2=2726,0=2727,2721=2728,21207=2729,-4=2730,0=2731,-1=2732,1206=2733,-1=2734,2739=2735,21101=2736,0=2737,0=2738,-4=2739,22101=2740,0=2741,-4=2742,1=2743,22102=2744,1=2745,-3=2746,2=2747,21101=2748,0=2749,1=2750,3=2751,21101=2752,2758=2753,0=2754,0=2755,1105=2756,1=2757,2763=2758,109=2759,-5=2760,2106=2761,0=2762,0=2763,109=2764,6=2765,21207=2766,-4=2767,1=2768,-1=2769,1206=2770,-1=2771,2786=2772,22207=2773,-5=2774,-3=2775,-1=2776,1206=2777,-1=2778,2786=2779,21202=2780,-5=2781,1=2782,-5=2783,1106=2784,0=2785,2858=2786,21201=2787,-5=2788,0=2789,1=2790,21201=2791,-4=2792,-1=2793,2=2794,21202=2795,-3=2796,2=2797,3=2798,21101=2799,2805=2800,0=2801,0=2802,1105=2803,1=2804,2763=2805,21201=2806,1=2807,0=2808,-5=2809,21102=2810,1=2811,1=2812,-2=2813,22207=2814,-5=2815,-3=2816,-1=2817,1206=2818,-1=2819,2824=2820,21101=2821,0=2822,0=2823,-2=2824,22202=2825,-3=2826,-2=2827,-3=2828,22107=2829,0=2830,-4=2831,-1=2832,1206=2833,-1=2834,2850=2835,22102=2836,1=2837,-2=2838,1=2839,21201=2840,-4=2841,-1=2842,2=2843,21102=2844,1=2845,2850=2846,0=2847,105=2848,1=2849,2721=2850,21202=2851,-3=2852,-1=2853,-3=2854,22201=2855,-5=2856,-3=2857,-5=2858,109=2859,-6=2860,2105=2861,1=2862,0=2863,109=2864,3=2865,21208=2866,-2=2867,0=2868,-1=2869,1205=2870,-1=2871,2902=2872,21207=2873,-2=2874,0=2875,-1=2876,1205=2877,-1=2878,2882=2879,1106=2880,0=2881,2888=2882,104=2883,45=2884,21202=2885,-2=2886,-1=2887,-2=2888,22101=2889,0=2890,-2=2891,1=2892,21101=2893,0=2894,2899=2895,0=2896,1105=2897,1=2898,2909=2899,1105=2900,1=2901,2904=2902,104=2903,48=2904,109=2905,-3=2906,2105=2907,1=2908,0=2909,109=2910,4=2911,21201=2912,-3=2913,0=2914,1=2915,21102=2916,10=2917,1=2918,2=2919,21102=2920,2926=2921,1=2922,0=2923,1105=2924,1=2925,3010=2926,21202=2927,1=2928,1=2929,-2=2930,21202=2931,2=2932,1=2933,-1=2934,1206=2935,-2=2936,2948=2937,21202=2938,-2=2939,1=2940,1=2941,21102=2942,1=2943,2948=2944,0=2945,1106=2946,0=2947,2909=2948,22101=2949,48=2950,-1=2951,-1=2952,204=2953,-1=2954,109=2955,-4=2956,2105=2957,1=2958,0=2959,1=2960,2=2961,4=2962,8=2963,16=2964,32=2965,64=2966,128=2967,256=2968,512=2969,1024=2970,2048=2971,4096=2972,8192=2973,16384=2974,32768=2975,65536=2976,131072=2977,262144=2978,524288=2979,1048576=2980,2097152=2981,4194304=2982,8388608=2983,16777216=2984,33554432=2985,67108864=2986,134217728=2987,268435456=2988,536870912=2989,1073741824=2990,2147483648=2991,4294967296=2992,8589934592=2993,17179869184=2994,34359738368=2995,68719476736=2996,137438953472=2997,274877906944=2998,549755813888=2999,1099511627776=3000,2199023255552=3001,4398046511104=3002,8796093022208=3003,17592186044416=3004,35184372088832=3005,70368744177664=3006,140737488355328=3007,281474976710656=3008,562949953421312=3009,1125899906842624=3010,109=3011,8=3012,21102=3013,0=3014,1=3015,-4=3016,21102=3017,1=3018,0=3019,-3=3020,21102=3021,1=3022,51=3023,-2=3024,21201=3025,-2=3026,-1=3027,-2=3028,1201=3029,-2=3030,2959=3031,3034=3032,20101=3033,0=3034,0=3035,-1=3036,21202=3037,-3=3038,2=3039,-3=3040,22207=3041,-7=3042,-1=3043,-5=3044,1205=3045,-5=3046,3059=3047,21201=3048,-3=3049,1=3050,-3=3051,22102=3052,-1=3053,-1=3054,-5=3055,22201=3056,-7=3057,-5=3058,-7=3059,22207=3060,-3=3061,-6=3062,-5=3063,1205=3064,-5=3065,3078=3066,22102=3067,-1=3068,-6=3069,-5=3070,22201=3071,-3=3072,-5=3073,-3=3074,22201=3075,-1=3076,-4=3077,-4=3078,1205=3079,-2=3080,3024=3081,21201=3082,-4=3083,0=3084,-7=3085,21201=3086,-3=3087,0=3088,-6=3089,109=3090,-8=3091,2105=3092,1=3093,0=3094,105=3095,110=3096,118=3097,-1=3098,-1=3099,-1=3100,-1=3101,-1=3102,-1=3103,-1=3104,-1=3105,-1=3106,-1=3107,-1=3108,-1=3109,-1=3110,-1=3111,-1=3112,-1=3113,-1=3114,-1=3115,-1=3116,-1=3117,-1=3118,-1=3119,-1=3120,-1=3121,-1=3122,-1=3123,-1=3124,3131=3125,3143=3126,0=3127,0=3128,0=3129,3252=3130,0=3131,11=3132,61=3133,105=3134,95=3135,94=3136,17=3137,50=3138,97=3139,83=3140,78=3141,79=3142,83=3143,108=3144,-19=3145,2=3146,7=3147,-79=3148,-9=3149,-2=3150,2=3151,-83=3152,-11=3153,-7=3154,-86=3155,-3=3156,-16=3157,-7=3158,-11=3159,-6=3160,-21=3161,-21=3162,-94=3163,-30=3164,-96=3165,-25=3166,-19=3167,-23=3168,-31=3169,-101=3170,-29=3171,-25=3172,-104=3173,-21=3174,-34=3175,-38=3176,-108=3177,-39=3178,-34=3179,-32=3180,-33=3181,-31=3182,-114=3183,-43=3184,-47=3185,-35=3186,-49=3187,-105=3188,-120=3189,-69=3190,-43=3191,-123=3192,-49=3193,-56=3194,-57=3195,-47=3196,-128=3197,-40=3198,-51=3199,-46=3200,-50=3201,-133=3202,-51=3203,-63=3204,-63=3205,-57=3206,-138=3207,-69=3208,-58=3209,-62=3210,-65=3211,-143=3212,-79=3213,-69=3214,-63=3215,-68=3216,-148=3217,-79=3218,-68=3219,-82=3220,-83=3221,-63=3222,-81=3223,-77=3224,-85=3225,-145=3226,-158=3227,-75=3228,-88=3229,-92=3230,-162=3231,-91=3232,-85=3233,-89=3234,-97=3235,-167=3236,-96=3237,-104=3238,-87=3239,-171=3240,-106=3241,-104=3242,-105=3243,-97=3244,-176=3245,-94=3246,-109=3247,-114=3248,-104=3249,-112=3250,-114=3251,-169=3252,3259=3253,3271=3254,0=3255,3124=3256,0=3257,3323=3258,3552=3259,11=3260,58=3261,98=3262,90=3263,91=3264,95=3265,85=3266,84=3267,96=3268,86=3269,90=3270,82=3271,51=3272,38=3273,59=3274,64=3275,-22=3276,60=3277,45=3278,44=3279,-26=3280,38=3281,-28=3282,58=3283,42=3284,42=3285,52=3286,36=3287,32=3288,44=3289,29=3290,45=3291,30=3292,-39=3293,47=3294,32=3295,42=3296,29=3297,-44=3298,35=3299,30=3300,18=3301,30=3302,34=3303,-50=3304,19=3305,27=3306,29=3307,-54=3308,-4=3309,24=3310,25=3311,15=3312,19=3313,11=3314,7=3315,20=3316,16=3317,9=3318,3=3319,-66=3320,19=3321,-50=3322,-55=3323,3330=3324,3337=3325,0=3326,3252=3327,0=3328,3378=3329,3477=3330,6=3331,59=3332,107=3333,91=3334,88=3335,90=3336,90=3337,40=3338,38=3339,70=3340,68=3341,58=3342,-12=3343,66=3344,56=3345,-15=3346,68=3347,55=3348,51=3349,-19=3350,47=3351,44=3352,44=3353,50=3354,54=3355,44=3356,58=3357,56=3358,-28=3359,54=3360,39=3361,38=3362,45=3363,-33=3364,50=3365,44=3366,-36=3367,35=3368,27=3369,47=3370,29=3371,-41=3372,38=3373,36=3374,43=3375,24=3376,36=3377,-33=3378,3385=3379,3399=3380,0=3381,3323=3382,0=3383,3724=3384,3435=3385,13=3386,54=3387,100=3388,86=3389,103=3390,15=3391,63=3392,98=3393,77=3394,93=3395,94=3396,78=3397,90=3398,90=3399,35=3400,49=3401,68=3402,64=3403,-6=3404,59=3405,61=3406,59=3407,73=3408,-11=3409,53=3410,69=3411,55=3412,-15=3413,49=3414,59=3415,58=3416,-19=3417,64=3418,58=3419,57=3420,-23=3421,59=3422,52=3423,39=3424,49=3425,48=3426,-29=3427,40=3428,48=3429,50=3430,-33=3431,55=3432,44=3433,49=3434,-23=3435,3442=3436,3450=3437,0=3438,0=3439,3378=3440,0=3441,0=3442,7=3443,68=3444,97=3445,107=3446,89=3447,93=3448,89=3449,97=3450,26=3451,43=3452,91=3453,73=3454,85=3455,91=3456,85=3457,72=3458,72=3459,76=3460,68=3461,3=3462,78=3463,-6=3464,63=3465,74=3466,60=3467,59=3468,79=3469,57=3470,0=3471,54=3472,67=3473,57=3474,52=3475,50=3476,-5=3477,3484=3478,3496=3479,0=3480,4239=3481,3323=3482,0=3483,0=3484,11=3485,72=3486,87=3487,92=3488,87=3489,95=3490,83=3491,84=3492,14=3493,57=3494,77=3495,77=3496,55=3497,34=3498,55=3499,60=3500,-26=3501,56=3502,41=3503,40=3504,-30=3505,38=3506,54=3507,40=3508,34=3509,34=3510,42=3511,30=3512,31=3513,-39=3514,32=3515,28=3516,40=3517,26=3518,-44=3519,34=3520,24=3521,-47=3522,32=3523,33=3524,29=3525,33=3526,27=3527,31=3528,35=3529,25=3530,13=3531,-57=3532,22=3533,20=3534,16=3535,28=3536,15=3537,6=3538,18=3539,-65=3540,2=3541,2=3542,15=3543,4=3544,1=3545,7=3546,-72=3547,14=3548,5=3549,7=3550,-1=3551,-63=3552,3559=3553,3567=3554,0=3555,0=3556,3252=3557,4024=3558,3644=3559,7=3560,65=3561,89=3562,99=3563,98=3564,108=3565,85=3566,108=3567,76=3568,8=3569,27=3570,27=3571,36=3572,-48=3573,16=3574,32=3575,18=3576,13=3577,-53=3578,18=3579,10=3580,27=3581,-57=3582,8=3583,10=3584,9=3585,17=3586,-62=3587,16=3588,16=3589,19=3590,7=3591,10=3592,5=3593,21=3594,-1=3595,-3=3596,-72=3597,-3=3598,5=3599,7=3600,-76=3601,6=3602,1=3603,-2=3604,-11=3605,3=3606,-10=3607,-10=3608,-6=3609,-14=3610,-59=3611,-87=3612,1=3613,-10=3614,-5=3615,-84=3616,-10=3617,-24=3618,-94=3619,-21=3620,-11=3621,-14=3622,-14=3623,-99=3624,-22=3625,-22=3626,-18=3627,-103=3628,-23=3629,-20=3630,-33=3631,-23=3632,-39=3633,-109=3634,-27=3635,-26=3636,-30=3637,-44=3638,-114=3639,-28=3640,-44=3641,-52=3642,-34=3643,-105=3644,3651=3645,3663=3646,0=3647,0=3648,3552=3649,3892=3650,4393=3651,11=3652,68=3653,86=3654,102=3655,87=3656,99=3657,102=3658,80=3659,98=3660,92=3661,94=3662,100=3663,60=3664,24=3665,43=3666,39=3667,51=3668,37=3669,-33=3670,31=3671,47=3672,33=3673,-37=3674,27=3675,-39=3676,30=3677,28=3678,45=3679,-43=3680,40=3681,24=3682,30=3683,22=3684,35=3685,18=3686,29=3687,29=3688,17=3689,30=3690,-27=3691,-55=3692,28=3693,15=3694,11=3695,30=3696,-53=3697,21=3698,7=3699,-63=3700,1=3701,11=3702,10=3703,-67=3704,-2=3705,10=3706,6=3707,13=3708,-3=3709,-5=3710,-74=3711,-7=3712,3=3713,10=3714,0=3715,-67=3716,-80=3717,3=3718,-10=3719,-4=3720,1=3721,-14=3722,-14=3723,-73=3724,3731=3725,3740=3726,0=3727,3378=3728,3965=3729,0=3730,3796=3731,8=3732,72=3733,88=3734,105=3735,104=3736,85=3737,90=3738,87=3739,100=3740,55=3741,29=3742,48=3743,44=3744,63=3745,-20=3746,54=3747,40=3748,-30=3749,34=3750,-32=3751,43=3752,39=3753,49=3754,48=3755,39=3756,31=3757,-39=3758,44=3759,46=3760,31=3761,40=3762,40=3763,44=3764,-46=3765,18=3766,30=3767,19=3768,-50=3769,32=3770,32=3771,12=3772,28=3773,29=3774,17=3775,21=3776,13=3777,-59=3778,24=3779,18=3780,-62=3781,13=3782,15=3783,14=3784,9=3785,-67=3786,-3=3787,7=3788,6=3789,-71=3790,-7=3791,3=3792,-1=3793,0=3794,-7=3795,-63=3796,3803=3797,3814=3798,0=3799,0=3800,3724=3801,0=3802,4093=3803,10=3804,68=3805,86=3806,106=3807,92=3808,89=3809,82=3810,100=3811,88=3812,93=3813,91=3814,77=3815,6=3816,38=3817,18=3818,36=3819,36=3820,33=3821,-25=3822,-52=3823,-2=3824,30=3825,27=3826,9=3827,21=3828,10=3829,10=3830,8=3831,-47=3832,-62=3833,-15=3834,12=3835,4=3836,-1=3837,16=3838,1=3839,-69=3840,13=3841,14=3842,8=3843,7=3844,2=3845,14=3846,-76=3847,0=3848,-9=3849,-14=3850,3=3851,4=3852,0=3853,-14=3854,-7=3855,-16=3856,-8=3857,-3=3858,-5=3859,-89=3860,-20=3861,-9=3862,-13=3863,-16=3864,-94=3865,-25=3866,-23=3867,-27=3868,-14=3869,-10=3870,-100=3871,-18=3872,-18=3873,-38=3874,-22=3875,-22=3876,-106=3877,-23=3878,-29=3879,-109=3880,-28=3881,-42=3882,-45=3883,-48=3884,-38=3885,-42=3886,-50=3887,-35=3888,-53=3889,-35=3890,-51=3891,-107=3892,3899=3893,3908=3894,0=3895,3644=3896,0=3897,0=3898,0=3899,8=3900,64=3901,102=3902,98=3903,100=3904,88=3905,88=3906,85=3907,92=3908,56=3909,27=3910,54=3911,51=3912,42=3913,51=3914,49=3915,39=3916,-31=3917,51=3918,36=3919,35=3920,42=3921,47=3922,-37=3923,46=3924,40=3925,-40=3926,31=3927,23=3928,43=3929,25=3930,-45=3931,30=3932,22=3933,22=3934,35=3935,-50=3936,22=3937,32=3938,-53=3939,25=3940,23=3941,-56=3942,27=3943,14=3944,10=3945,-60=3946,-22=3947,11=3948,2=3949,14=3950,19=3951,-66=3952,-28=3953,14=3954,4=3955,-2=3956,-71=3957,11=3958,-4=3959,10=3960,9=3961,-3=3962,1=3963,-7=3964,-65=3965,3972=3966,3995=3967,0=3968,0=3969,0=3970,0=3971,3724=3972,22=3973,50=3974,88=3975,92=3976,7=3977,41=3978,77=3979,83=3980,70=3981,81=3982,77=3983,65=3984,83=3985,67=3986,-3=3987,34=3988,74=3989,79=3990,71=3991,76=3992,56=3993,63=3994,67=3995,28=3996,55=3997,82=3998,79=3999,70=4000,72=4001,78=4002,85=4003,9=4004,-4=4005,68=4006,78=4007,0=4008,75=4009,-9=4010,73=4011,73=4012,61=4013,63=4014,62=4015,-15=4016,71=4017,62=4018,64=4019,56=4020,53=4021,57=4022,49=4023,-9=4024,4031=4025,4052=4026,0=4027,3552=4028,0=4029,0=4030,0=4031,20=4032,51=4033,84=4034,80=4035,93=4036,8=4037,62=4038,88=4039,70=4040,84=4041,83=4042,75=4043,79=4044,71=4045,-1=4046,33=4047,66=4048,74=4049,79=4050,63=4051,75=4052,40=4053,32=4054,70=4055,77=4056,-11=4057,57=4058,63=4059,69=4060,54=4061,-16=4062,51=4063,61=4064,-19=4065,69=4066,58=4067,63=4068,-23=4069,63=4070,57=4071,39=4072,53=4073,-28=4074,51=4075,52=4076,38=4077,51=4078,36=4079,44=4080,49=4081,47=4082,-37=4083,41=4084,39=4085,-40=4086,43=4087,30=4088,26=4089,-44=4090,26=4091,33=4092,-16=4093,4100=4094,4109=4095,0=4096,0=4097,3796=4098,4189=4099,0=4100,8=4101,59=4102,102=4103,104=4104,103=4105,93=4106,87=4107,97=4108,99=4109,79=4110,5=4111,24=4112,20=4113,-50=4114,26=4115,17=4116,31=4117,11=4118,21=4119,-56=4120,30=4121,7=4122,17=4123,16=4124,22=4125,-62=4126,2=4127,14=4128,3=4129,-66=4130,17=4131,4=4132,0=4133,-70=4134,6=4135,-3=4136,11=4137,-9=4138,1=4139,-76=4140,-7=4141,-2=4142,0=4143,-1=4144,1=4145,-82=4146,-18=4147,-2=4148,-16=4149,-86=4150,-4=4151,-12=4152,-16=4153,-19=4154,-19=4155,-8=4156,-17=4157,-5=4158,-95=4159,-28=4160,-24=4161,-28=4162,-29=4163,-31=4164,-19=4165,-33=4166,-25=4167,-20=4168,-105=4169,-39=4170,-28=4171,-32=4172,-30=4173,-28=4174,-28=4175,-98=4176,-113=4177,-67=4178,-33=4179,-116=4180,-52=4181,-36=4182,-50=4183,-120=4184,-37=4185,-50=4186,-54=4187,-35=4188,-94=4189,4196=4190,4204=4191,0=4192,4093=4193,0=4194,0=4195,0=4196,7=4197,76=4198,108=4199,88=4200,88=4201,97=4202,89=4203,102=4204,34=4205,48=4206,66=4207,69=4208,73=4209,62=4210,62=4211,61=4212,73=4213,3=4214,72=4215,61=4216,77=4217,55=4218,53=4219,-2=4220,-17=4221,34=4222,53=4223,49=4224,68=4225,-15=4226,59=4227,45=4228,-25=4229,39=4230,49=4231,48=4232,-29=4233,39=4234,46=4235,48=4236,51=4237,55=4238,-21=4239,4246=4240,4269=4241,0=4242,4304=4243,0=4244,3477=4245,0=4246,22=4247,65=4248,74=4249,90=4250,87=4251,6=4252,41=4253,86=4254,76=4255,88=4256,70=4257,0=4258,44=4259,63=4260,70=4261,74=4262,79=4263,63=4264,71=4265,57=4266,69=4267,57=4268,58=4269,34=4270,39=4271,81=4272,-4=4273,60=4274,74=4275,73=4276,61=4277,56=4278,72=4279,72=4280,-12=4281,71=4282,65=4283,-15=4284,50=4285,52=4286,-18=4287,68=4288,59=4289,61=4290,53=4291,50=4292,54=4293,46=4294,-26=4295,51=4296,51=4297,53=4298,47=4299,34=4300,44=4301,43=4302,55=4303,-21=4304,4311=4305,4320=4306,0=4307,0=4308,0=4309,4239=4310,0=4311,8=4312,75=4313,96=4314,89=4315,96=4316,20=4317,53=4318,83=4319,106=4320,72=4321,11=4322,44=4323,38=4324,37=4325,35=4326,37=4327,38=4328,36=4329,-48=4330,17=4331,29=4332,33=4333,20=4334,-53=4335,-4=4336,14=4337,12=4338,-44=4339,-12=4340,20=4341,23=4342,8=4343,6=4344,-63=4345,-14=4346,4=4347,7=4348,11=4349,0=4350,0=4351,-1=4352,11=4353,-72=4354,4=4355,-5=4356,-7=4357,-3=4358,-10=4359,-5=4360,-1=4361,-11=4362,-81=4363,-17=4364,-5=4365,-16=4366,-85=4367,-4=4368,-18=4369,-17=4370,-4=4371,-14=4372,-26=4373,-10=4374,-93=4375,-12=4376,-26=4377,-23=4378,-19=4379,-30=4380,-30=4381,-31=4382,-19=4383,-102=4384,-26=4385,-35=4386,-37=4387,-33=4388,-40=4389,-35=4390,-31=4391,-41=4392,-97=4393,4400=4394,4408=4395,0=4396,0=4397,3644=4398,0=4399,4457=4400,7=4401,76=4402,108=4403,102=4404,104=4405,86=4406,91=4407,88=4408,48=4409,36=4410,55=4411,51=4412,-19=4413,46=4414,58=4415,66=4416,46=4417,59=4418,-25=4419,48=4420,58=4421,55=4422,55=4423,-30=4424,36=4425,47=4426,45=4427,50=4428,30=4429,37=4430,41=4431,-38=4432,38=4433,39=4434,41=4435,27=4436,-43=4437,22=4438,34=4439,42=4440,22=4441,35=4442,-35=4443,-50=4444,-51=4445,-2=4446,16=4447,13=4448,30=4449,26=4450,26=4451,15=4452,27=4453,9=4454,15=4455,27=4456,-49=4457,4464=4458,4484=4459,0=4460,0=4461,4393=4462,0=4463,4556=4464,19=4465,64=4466,81=4467,78=4468,95=4469,91=4470,81=4471,91=4472,95=4473,5=4474,39=4475,75=4476,71=4477,68=4478,75=4479,79=4480,77=4481,70=4482,74=4483,79=4484,71=4485,2=4486,38=4487,-41=4488,42=4489,29=4490,25=4491,-45=4492,32=4493,22=4494,40=4495,35=4496,-50=4497,31=4498,27=4499,26=4500,23=4501,-43=4502,-56=4503,8=4504,-58=4505,21=4506,22=4507,8=4508,21=4509,20=4510,21=4511,17=4512,3=4513,-54=4514,15=4515,0=4516,8=4517,12=4518,1=4519,11=4520,-1=4521,11=4522,-7=4523,-77=4524,-8=4525,-3=4526,-1=4527,-2=4528,0=4529,-83=4530,3=4531,-12=4532,-10=4533,-11=4534,-88=4535,-3=4536,-21=4537,-9=4538,-19=4539,-23=4540,-5=4541,-95=4542,-7=4543,-18=4544,-13=4545,-17=4546,-100=4547,-28=4548,-34=4549,-34=4550,-26=4551,-21=4552,-33=4553,-23=4554,-19=4555,-95=4556,4563=4557,4588=4558,1553=4559,0=4560,4457=4561,0=4562,0=4563,24=4564,56=4565,89=4566,75=4567,88=4568,87=4569,88=4570,84=4571,70=4572,13=4573,50=4574,67=4575,75=4576,79=4577,68=4578,78=4579,66=4580,78=4581,60=4582,-10=4583,27=4584,64=4585,66=4586,65=4587,67=4588,12=4589,53=4590,97=4591,83=4592,93=4593,105=4594,105=4595,87=4596,91=4597,83=4598,25=4599,24=4600,23=4601,3323=4602,4653=4603,27=4604,1872=4605,3965=4606,4661=4607,28=4608,1818=4609,4457=4610,4681=4611,134217757=4612,0=4613,4457=4614,4690=4615,262174=4616,0=4617,4457=4618,4698=4619,2079=4620,0=4621,4457=4622,4709=4623,64=4624,0=4625,4239=4626,4722=4627,33=4628,1850=4629,4457=4630,4734=4631,65570=4632,0=4633,3252=4634,4738=4635,35=4636,1829=4637,3552=4638,4752=4639,36=4640,1796=4641,4457=4642,4763=4643,2147483685=4644,0=4645,4457=4646,4774=4647,42=4648,0=4649,4457=4650,4786=4651,167=4652,0=4653,7=4654,105=4655,96=4656,102=4657,106=4658,100=4659,98=4660,102=4661,19=4662,84=4663,85=4664,76=4665,88=4666,93=4667,8=4668,76=4669,82=4670,74=4671,71=4672,87=4673,84=4674,80=4675,77=4676,64=4677,69=4678,75=4679,65=4680,79=4681,8=4682,89=4683,106=4684,106=4685,90=4686,102=4687,92=4688,101=4689,92=4690,7=4691,90=4692,102=4693,107=4694,91=4695,99=4696,98=4697,84=4698,10=4699,91=4700,86=4701,103=4702,103=4703,87=4704,99=4705,16=4706,84=4707,85=4708,84=4709,12=4710,103=4711,99=4712,83=4713,84=4714,85=4715,15=4716,86=4717,82=4718,77=4719,95=4720,79=4721,91=4722,11=4723,98=4724,99=4725,95=4726,102=4727,86=4728,94=4729,15=4730,90=4731,78=4732,98=4733,76=4734,3=4735,103=4736,93=4737,104=4738,13=4739,92=4740,96=4741,87=4742,89=4743,93=4744,87=4745,97=4746,81=4747,11=4748,86=4749,88=4750,87=4751,87=4752,10=4753,91=4754,104=4755,87=4756,84=4757,98=4758,86=4759,16=4760,95=4761,93=4762,81=4763,10=4764,106=4765,86=4766,97=4767,85=4768,97=4769,102=4770,98=4771,88=4772,92=4773,82=4774,11=4775,91=4776,89=4777,102=4778,102=4779,90=4780,102=4781,84=4782,14=4783,85=4784,77=4785,95=4786,11=4787,91=4788,93=4789,107=4790,87=4791,85=4792,16=4793,95=4794,93=4795,86=4796,90=4797,95=4799,166=4798,24=4802,1256=4801,167=4804,10=4805,0=4803,9=4807,-9=4806,1222=4808,9=4810,10=4811,-53=4812,31=4809,10=4813,32=4814,10=4815,4=4817,7=4816,1=4818,7=4820,1222=4821,84=4822,6=4819,1=4823,7=4800,1251=4824,97=4825,6=4827,1=4828,4787=4829,1256=4826,7=4830,11=4831,11=4832,1=4834,95=4835,10=4836,11=4833,1222=4838,1=4840,0=4841,29=4842,0=4839,2850=4844,1=4846,0=4847,28=4848,0=4845,2850=4850,1=4852,0=4853,27=4854,0=4851,2850=4856,1=4858,0=4859,26=4860,0=4857,2850=4862,1=4864,0=4865,25=4866,0=4863,2850=4868,1=4870,0=4871,24=4872,0=4869,2850=4874,1=4876,0=4877,23=4878,0=4875,2850=4880,1=4882,0=4883,22=4884,0=4881,2850=4886,1=4888,0=4889,21=4890,0=4887,2850=4892,1=4894,0=4895,20=4896,0=4893,2850=4898,1=4900,0=4901,19=4902,0=4899,2850=4904,1=4906,0=4907,18=4908,0=4905,2850=4910,1=4912,0=4913,17=4914,0=4911,2850=4916,1=4918,0=4919,16=4920,0=4917,2850=4922,1=4924,0=4925,15=4926,-262144=4923,2850=4928,1=4930,1=4931,14=4932,0=4929,2850=4934,1=4936,0=4937,13=4938,0=4935,2850=4940,1=4942,0=4943,12=4944,0=4941,2850=4946,1=4948,0=4949,11=4950,0=4947,2850=4952,1=4954,0=4955,10=4956,0=4953,2850=4958,1=4960,0=4961,9=4962,0=4959,2850=4964,1=4966,0=4967,8=4968,0=4965,2850=4970,1=4972,0=4973,7=4974,0=4971,2850=4976,1=4978,0=4979,6=4980,0=4977,2850=4982,1=4984,0=4985,5=4986,0=4983,2850=4988,1=4990,0=4991,4=4992,0=4989,2850=4994,1=4996,0=4997,3=4998,0=4995,2850=5000,1=5002,0=5003,2=5004,0=5001,2850=5006,1=5008,0=5009,1=5010,8136=5007,2850=5012,1=5014,0=5015,0=5016,7482=5013,2850=5018,1=5011,0=5017,1=5005,0=4999,0=4993,0=4987,0=4981,0=4975,0=4969,0=4963,0=4957,0=4951,0=4945,0=4939,0=4933,0=4927,0=4921,0=4915,0=4909,0=4903,0=4897,0=4891,0=4885,0=4879,0=4873,0=4867,0=4861,0=4855,0=4849,0=4843,0=4837,116=";
    if (restore != "")
    {
        var split = restore.Split("||");
        machine.i = int.Parse(split.ElementAt(0));
        machine.relativeBase = int.Parse(split.ElementAt(1));
        //var aaa = split.ElementAt(2).Split("=").Select(x => x.Split(',').Select(long.Parse)).ToDictionary(x => x.First(), x=> x.Last());
        machine.operations = split.ElementAt(2).Split("=", StringSplitOptions.RemoveEmptyEntries).Select(x => x.Split(',', StringSplitOptions.RemoveEmptyEntries).Select(long.Parse)).ToDictionary(x => x.First(), x => x.Last());
    }

    var skip = restore != "";
    while (true)
    {

        if (skip)
        {
            goto lala;
        }
        var output = machine.Execute();
        if (output == stopOutput) { break; }
        str += (char)output;
        Console.Write((char)output);
    lala:
        if (str.EndsWith("Command?" + newLine) || skip)
        {
            skip = false;
            var clone = new StringBuilder();
            clone.Append($"{machine.i}||");
            clone.Append($"{machine.relativeBase}||");
            foreach (var item in machine.operations)
            {
                clone.Append($"{item.Key},{item.Value}=");
            }
            var aaa = clone.ToString();

            string command;
            if (i < combination.Length)
            {
                command = $"take {combination[i]}" + newLine;
                i++;
            }
            else if (combination.Length == i)
            {
                command = $"west" + newLine;
                i++;
            }
            else
            {
                //Console.ReadKey();
                goto next;
                command = Console.ReadLine() + newLine;
            }
            foreach (var item in command)
            {
                machine.inputBuffer.Enqueue(item);
            }
        }
    }
next:;
}


Console.Write(str);


timer.Stop();
Console.WriteLine(result);
Console.WriteLine(timer.ElapsedMilliseconds + "ms");
Console.ReadLine();


enum OpCode { Unknown = 0, Add = 1, Multiply = 2, Input = 3, Output = 4, JumpIfTrue = 5, JumpIfFalse = 6, LessThan = 7, Equals = 8, AdjustRelativeBase = 9, Stop = 99 }
enum ParameterMode { Position = 0, Value = 1, Relative = 2 }
class StateMachine
{
    private ParameterMode GetParameterMode(char v) => (ParameterMode)int.Parse(v.ToString());
    (ParameterMode parameterMode1, ParameterMode parameterMode2, ParameterMode parameterMode3, OpCode opCode) GetOpcode(long input)
    {
        var inputString = input.ToString();
        var opCode = (OpCode)int.Parse(new string(inputString.TakeLast(2).ToArray()));
        var parameterMode1 = ParameterMode.Position;
        var parameterMode2 = ParameterMode.Position;
        var parameterMode3 = ParameterMode.Position;
        if (inputString.Length == 3)
        {
            parameterMode1 = GetParameterMode(inputString[0]);
        }
        else if (inputString.Length == 4)
        {
            parameterMode2 = GetParameterMode(inputString[0]);
            parameterMode1 = GetParameterMode(inputString[1]);
        }
        else if (inputString.Length == 5)
        {
            parameterMode3 = GetParameterMode(inputString[0]);
            parameterMode2 = GetParameterMode(inputString[1]);
            parameterMode1 = GetParameterMode(inputString[2]);
        }
        return (parameterMode1, parameterMode2, parameterMode3, opCode);
    }

    public Queue<long> inputBuffer { get; set; } = new Queue<long>();
    public List<long> outputBuffer { get; set; } = new List<long>();
    public long i { get; set; }
    public long relativeBase { get; set; }
    public Dictionary<long, long> operations { get; set; }

    long GetOrDefault(long address)
    {
        if (operations.TryGetValue(address, out var result))
        {
            return result;
        }
        return 0;
    }
    long Get(ParameterMode mode, long address)
    {
        switch (mode)
        {
            case ParameterMode.Position: return GetOrDefault(GetOrDefault(address));
            case ParameterMode.Value: return GetOrDefault(address);
            case ParameterMode.Relative: return GetOrDefault(relativeBase + GetOrDefault(address));
            default: throw new ArgumentOutOfRangeException();
        }
    }

    void Set(ParameterMode mode, long address, long value)
    {
        switch (mode)
        {
            case ParameterMode.Position: operations[GetOrDefault(address)] = value; break;
            case ParameterMode.Value: operations[address] = value; break;
            case ParameterMode.Relative: operations[relativeBase + GetOrDefault(address)] = value; break;
            default: throw new ArgumentOutOfRangeException();
        }
    }

    private bool first = true;
    public long Execute()
    {
        while (true)
        {
            var opCode = GetOpcode(operations[i]);
            switch (opCode.opCode)
            {
                case OpCode.Stop:
                    {
                        //return operations[0];
                        //throw new InvalidOperationException();
                        return long.MinValue;
                    }
                case OpCode.Add:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        var value = param1 + param2;
                        Set(opCode.parameterMode3, i + 3, value);
                        i += 4;
                    }
                    break;
                case OpCode.Multiply:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        var value = param1 * param2;
                        Set(opCode.parameterMode3, i + 3, value);
                        i += 4;
                    }
                    break;
                case OpCode.Input:
                    {
                        if (!inputBuffer.TryDequeue(out var input))
                        {
                            input = -1;
                        }

                        Set(opCode.parameterMode1, i + 1, input);
                        first = false;
                        i += 2;
                    }
                    break;
                case OpCode.Output:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        outputBuffer.Add(param1);
                        i += 2;
                        return param1;
                    }
                    break;
                case OpCode.JumpIfTrue:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        if (param1 != 0)
                        {
                            i = param2;
                        }
                        else
                        {
                            i += 3;
                        }
                    }
                    break;
                case OpCode.JumpIfFalse:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        if (param1 == 0)
                        {
                            i = param2;
                        }
                        else
                        {
                            i += 3;
                        }
                    }
                    break;
                case OpCode.LessThan:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        var value = param1 < param2 ? 1 : 0;
                        Set(opCode.parameterMode3, i + 3, value);
                        i += 4;
                    }
                    break;
                case OpCode.Equals:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        var param2 = Get(opCode.parameterMode2, i + 2);
                        var value = param1 == param2 ? 1 : 0;
                        Set(opCode.parameterMode3, i + 3, value);
                        i += 4;
                    }
                    break;
                case OpCode.AdjustRelativeBase:
                    {
                        var param1 = Get(opCode.parameterMode1, i + 1);
                        relativeBase += param1;
                        i += 2;
                    }
                    break;
                default:
                    {
                        throw new Exception();
                    }
            }
        }
    }
}